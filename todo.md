# 代办事项

- pkg --diff 在使用时能够正确的处理版本的升级相互依赖情况
  - 现在仅判断安装的版本与实际版本的对照，可能造成误判

package.json 中 dependencies 依赖的版本号写法主要有以下 8 种类型，具体规则及适用场景如下：

---

一、**精确版本号**
直接指定固定版本，仅允许安装完全匹配的版本。  
语法示例：

```json
"lodash": "4.17.21"
```

特点：  
• 完全锁定依赖版本，避免意外升级

• 适用于需严格兼容的场景（如核心库）

---

二、**波浪符号（~）**
允许更新修订号（Patch）和次版本号（Minor）的特定范围。  
语法示例：

```json
"react": "~16.13.1"  // 允许 16.13.1 ≤ version < 16.14.0
"express": "~1.2"    // 允许 1.2.0 ≤ version < 1.3.0
```

匹配规则：  
• 若指定完整版本（如 `~1.2.3`），允许修订号升级（1.2.3 → 1.2.4）

• 若省略修订号（如 `~1.2`），允许次版本号升级（1.2.0 → 1.3.0）

---

三、**插入符号（^）**
允许更新次版本号（Minor）和修订号（Patch），但主版本号（Major）固定。  
语法示例：

```json
"vue": "^2.6.12"  // 允许 2.6.12 ≤ version < 3.0.0
"redux": "^0.1.0" // 允许 0.1.0 ≤ version < 0.2.0
```

特殊规则：  
• 若主版本号为 0（如 `^0.1.2`），仅允许修订号升级（0.1.2 → 0.1.3）

• 默认安装时优先使用此符号

---

四、**通配符（x 或 \*）**
允许特定位置版本号自由升级。  
语法示例：

```json
"webpack": "5.x.x"   // 允许 5.0.0 ≤ version < 6.0.0
"babel": "*"         // 允许任何版本（慎用）
```

适用场景：  
• 开发初期快速迭代时使用 `x` 占位符

• `*` 表示安装最新版本（含不稳定版）

---

五、**范围指定符**
通过运算符定义精确范围。  
语法示例：

```json
"typescript": ">=4.3.0 <5.0.0"  // 4.3.0 ≤ version < 5.0.0
"jest": ">3.8.0"                // 必须大于 3.8.0
```

运算符类型：  
• `>`（大于）、`>=`（大于等于）

• `<`（小于）、`<=`（小于等于）

• `-` 表示区间（如 `1.2.3 - 2.3.4`）

---

六、**预发布版本标签**
指定包含先行测试版的版本。  
语法示例：

```json
"angular": "2.0.0-beta.6"
"react": "18.0.0-alpha-6a728c0a4"
```

常见标签：  
• `alpha`（内测版）、`beta`（公测版）

• `rc`（候选发布版）

---

七、**语义化版本别名**
通过标签引用特定版本状态。  
语法示例：

```json
"express": "latest"  // 安装最新稳定版
"webpack": "next"    // 安装预发布版
```

---

八、**Git/URL 引用**
直接指定 Git 仓库或压缩包地址。  
语法示例：

```json
"cli": "git+ssh://git@github.com/npm/cli.git#v1.0.27"
"utils": "https://example.com/utils-1.0.0.tgz"
```

---

版本号升级规则总结
| 符号 | 主版本号 | 次版本号 | 修订号 | 典型场景 |
|-----------|----------|----------|----------|--------------------------|
| `1.2.3` | 固定 | 固定 | 固定 | 生产环境核心依赖 |
| `^1.2.3` | 固定 | 允许升级 | 允许升级 | 默认推荐（兼容性优先） |
| `~1.2.3` | 固定 | 固定 | 允许升级 | 安全修复场景 |
| `1.x` | 固定 | 允许升级 | 允许升级 | 开发阶段快速迭代 |

建议优先使用 `^` 符号以平衡稳定性和功能更新，对于 0.x 版本依赖则推荐使用 `~` 符号。
